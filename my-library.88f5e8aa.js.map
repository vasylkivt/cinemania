{"mappings":"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","sources":["src/js/pages/my-library/my-library.js","src/js/pages/my-library/refs.js","src/js/components/select.js","src/js/pages/my-library/markupContentTextMessage.js"],"sourcesContent":["import Storage from '../../api/localStorageAPI/localStorageAPI';\nimport { STORAGE_KEY } from '../../localStorageKey/localStorageKey';\nimport { refs } from './refs';\nimport { createMarkupFilmsCards } from '../../components/createMarkupFilmCard';\nimport { markupContentTextMessage } from './markupContentTextMessage';\nimport { Loader } from '../../loader';\nimport { SelectService } from '../../components/select';\n\nconst PER_PAGE = 6;\n\nconst loader = new Loader();\n\nlet correctGenre = 'All';\nlet totalPage;\nlet page = 0;\nlet startIndex = 0;\nlet endIndex = 0;\nlet correctGenreMovieList = [];\n\nconst dataStorage = Storage.load(STORAGE_KEY.myLibraryMoviesList);\n\nrenderContentBasedOnConditions();\n\ndocument.addEventListener('click', function (e) {\n  if (e.target.dataset.action === 'add-remove-to-my-library') {\n    const dataStorage = Storage.load(STORAGE_KEY.myLibraryMoviesList);\n    if (dataStorage.length === 0) {\n      // refs.genreList.removeEventListener('change', onSelectGenreListChange);\n      refs.myLibrarySection.classList.add(\n        'my-library-content-text-message-section'\n      );\n      refs.libraryContent.innerHTML = markupContentTextMessage();\n    }\n\n    renderLibraryCards(dataStorage);\n  }\n});\n\nfunction renderContentBasedOnConditions() {\n  if (dataStorage?.length === 0) {\n    refs.genreList.removeEventListener('click', renderGenreList);\n    refs.myLibrarySection.classList.add(\n      'my-library-content-text-message-section'\n    );\n    refs.libraryContent.innerHTML = markupContentTextMessage();\n  } else if (dataStorage) {\n    //? Отримую унікальні ID жанрів фільмів, які є у localStorage і за допомогою функції createSelectOptionMarkup отримую розмітку з жанром, і вставляю у select\n    2;\n    const allGenres = dataStorage\n      .reduce((acc, el) => [...acc, ...el.genres], [])\n      .filter(\n        (genre, index, self) =>\n          index ===\n          self.findIndex(g => g.id === genre.id && g.name === genre.name)\n      );\n\n    const markupString = createSelectOption(allGenres);\n\n    const selectService = new SelectService(\n      '.js-select-my-library-genre-list',\n      markupString\n    );\n    selectService.addEventListenerSelect();\n\n    document\n      .querySelector('.select-my-library-option-list')\n      .addEventListener('click', renderGenreList);\n\n    renderLibraryCards(dataStorage);\n  } else {\n    refs.genreList.removeEventListener('click', renderGenreList);\n    refs.myLibrarySection.classList.add(\n      'my-library-content-text-message-section'\n    );\n    refs.libraryContent.innerHTML = markupContentTextMessage();\n  }\n}\n\nfunction createSelectOption(options) {\n  return options.map(({ id, name }) => {\n    return { value: id, text: name };\n  });\n}\n\nfunction renderGenreList(e) {\n  correctGenre = e.target.textContent;\n\n  page = 0;\n\n  if (correctGenre === 'All Genres') {\n    correctGenre = 'All Genres';\n    renderLibraryCards(dataStorage);\n    return;\n  }\n\n  correctGenreMovieList = dataStorage.filter(el => {\n    return el.genres.some(genre => genre.name === correctGenre);\n  });\n\n  renderLibraryCards(correctGenreMovieList);\n}\n\nasync function renderLibraryCards(movieList) {\n  loader.onShow();\n  startIndex = 0;\n  endIndex = PER_PAGE;\n  refs.moviesList.innerHTML = '';\n  refs.loadMoreButton.style.display = 'none';\n  if (movieList.length > PER_PAGE) {\n    refs.loadMoreButton.style.display = 'block';\n    refs.loadMoreButton.addEventListener('click', onloadMoreButtonClick);\n    localStoragePagination(startIndex, endIndex, movieList);\n  } else {\n    refs.moviesList.innerHTML = await createMarkupFilmsCards(movieList);\n  }\n  loader.onClose();\n}\n\nfunction onloadMoreButtonClick() {\n  loader.onShow();\n  refs.loadMoreButton.blur();\n\n  startIndex += PER_PAGE;\n  endIndex += PER_PAGE;\n\n  if (correctGenre === 'All Genres') {\n    localStoragePagination(startIndex, endIndex, dataStorage);\n  } else {\n    localStoragePagination(startIndex, endIndex, correctGenreMovieList);\n  }\n  loader.onClose();\n}\n\nasync function localStoragePagination(start, end, data) {\n  page += 1;\n\n  totalPage = data.length / PER_PAGE;\n\n  if (totalPage > page) {\n    const pagination = data.slice(start, end);\n\n    refs.moviesList.insertAdjacentHTML(\n      'beforeend',\n      await createMarkupFilmsCards(pagination)\n    );\n  } else {\n    const pagination = data.slice(start, end);\n    refs.moviesList.insertAdjacentHTML(\n      'beforeend',\n      await createMarkupFilmsCards(pagination)\n    );\n\n    refs.loadMoreButton.style.display = 'none';\n  }\n}\n","export const refs = {\n  myLibrarySection: document.getElementById('my-library'),\n  libraryContent: document.querySelector('.js-my-library-content'),\n  genreList: document.querySelector('.js-my-library-genre-list'),\n  moviesList: document.querySelector('.js-my-library-movies-list'),\n  loadMoreButton: document.querySelector('.js-my-library-load-more-button'),\n};\n","export class SelectService {\n  constructor(select, optionData = null) {\n    this.select = document.querySelector(select);\n\n    this.selectedValue = this.select.firstElementChild;\n    this.optionList = this.select.lastElementChild;\n    this.optionListFirstElementChild = this.optionList.firstElementChild;\n    this.optionData = optionData;\n    this.optionListValue = null;\n  }\n\n  addEventListenerSelect() {\n    this.select.classList.add('cs-select');\n    this.selectedValue.classList.add('cs-selected-option');\n    this.optionList.classList.add('cs-option-list');\n    this.optionListFirstElementChild.classList.add('cs-option');\n\n    this.selectedValue.addEventListener(\n      'mouseenter',\n      this.onSelectHover.bind(this)\n    );\n    this.selectedValue.addEventListener(\n      'mouseleave',\n      this.onSelectLostHover.bind(this)\n    );\n    this.optionList.addEventListener(\n      'mouseenter',\n      this.onSelectHover.bind(this)\n    );\n    this.optionList.addEventListener(\n      'mouseleave',\n      this.onSelectLostHover.bind(this)\n    );\n    if (this.optionData) {\n      this.optionList.insertAdjacentHTML(\n        'beforeend',\n        this.optionData\n          .map(\n            ({ value, text }) =>\n              `<div class=\"cs-option\" data-value=\"${value}\" class=\"\">${text}</div>`\n          )\n          .join('')\n      );\n    }\n  }\n\n  onSelectHover(e) {\n    this.select.classList.add('cs-select-active');\n\n    this.optionList.addEventListener('click', this.onOptionClick.bind(this));\n  }\n\n  onSelectLostHover(e) {\n    this.select.classList.remove('cs-select-active');\n    this.optionList.removeEventListener('click', this.onOptionClick.bind(this));\n  }\n\n  onOptionClick(e) {\n    this.optionListValue = e.target.textContent;\n    this.selectedValue.firstChild.textContent = this.optionListValue;\n    this.select.classList.remove('cs-select-active');\n\n    this.optionList.removeEventListener('click', this.onOptionClick);\n  }\n}\n\n//? ініціалізація екземпляра\n//  const selectService = new SelectService('Селектор', [markup]);\n//\n// selectService.addEventListenerSelect();\n\n//? html\n{\n  /* <div class=\"Селектор\">\n  <div>\n    All Genres\n    [svg-icon]\n  </div >\n    <div>\n      <div>All Genres</div>\n    </div>\n</div> */\n}\n\n//? css\n// .selected-option,\n// .option-list,\n// .option-list > div {\n//   position: relative;\n//   z-index: 11;\n//   background-color: rgb(41, 41, 41);\n// }\n\n// .selected-option,\n// .option-list > div {\n//   padding-top: 10px;\n//   padding-bottom: 10px;\n//   padding-right: 10px;\n//   padding-left: 10px;\n// }\n\n// .selected-option {\n//   border: 1px solid rgb(141, 141, 141);\n//   border-radius: 4px;\n// }\n\n// .option-list {\n//   /* pointer-events: none; */\n//   opacity: 0;\n//   visibility: hidden;\n//   position: absolute;\n\n//   transform: scaleY(0);\n//   transform-origin: top;\n\n//   transition: opacity 300ms ease-in-out, visibility 300ms ease-in-out,\n//     transform 300ms ease-in-out;\n// }\n\n// .option-list > div {\n//   border: 1px solid rgb(141, 141, 141);\n// }\n\n// .option-list > div:last-child {\n//   border-radius: 0px 0px 4px 4px;\n// }\n\n// .select-active .option-list {\n//   opacity: 1;\n//   visibility: visible;\n\n//   transform: scaleY(1);\n// }\n\n// .select-active .selected-option {\n//   border-radius: 4px 4px 0px 0px;\n// }\n","export function markupContentTextMessage() {\n  return ` \n    <p class=\"my-library-content-text-message\">\n        <span>OOPS...</span>\n        <span>We are very sorry!</span>\n        <span>You don’t have any movies at your library.</span>\n    </p>\n    <a class=\"button-accent my-library-content-text-message-button\" href=\"./catalog.html\">Search movie</a>\n    `;\n}\n"],"names":["$bpxeT","parcelRequire","$e51e8fcee1d77125$export$21666b427502ea6d","myLibrarySection","document","getElementById","libraryContent","querySelector","genreList","moviesList","loadMoreButton","$8MBJY","$b55f42aede91e26b$export$448ee86705ad98f3","SelectService","select","optionData","arguments","length","this","selectedValue","firstElementChild","optionList","lastElementChild","optionListFirstElementChild","optionListValue","key","classList","add","addEventListener","onSelectHover","bind","onSelectLostHover","insertAdjacentHTML","map","param","value","text","concat","join","e","onOptionClick","remove","removeEventListener","target","textContent","firstChild","$3c15aba5a275eda1$var$loader","$kvC6y","Loader","$3c15aba5a275eda1$var$correctGenre","$3c15aba5a275eda1$var$page","$3c15aba5a275eda1$var$startIndex","$3c15aba5a275eda1$var$endIndex","$3c15aba5a275eda1$var$correctGenreMovieList","$3c15aba5a275eda1$var$dataStorage","$5C21v","default","load","$cY1yb","STORAGE_KEY","myLibraryMoviesList","$3c15aba5a275eda1$var$renderGenreList","$3c15aba5a275eda1$var$renderLibraryCards","filter","el","genres","some","genre","name","movieList","$3c15aba5a275eda1$var$_renderLibraryCards","apply","$parcel$interopDefault","$2TvXO","mark","_callee","onShow","innerHTML","style","display","$3c15aba5a275eda1$var$onloadMoreButtonClick","$3c15aba5a275eda1$var$localStoragePagination","$bxNz7","createMarkupFilmsCards","_ctx","sent","onClose","blur","start","end","data","$3c15aba5a275eda1$var$_localStoragePagination","pagination","pagination1","slice","t0","call","t1","t2","t3","allGenres","reduce","acc","$8nrFW","index","self","findIndex","g","id","markupString","addEventListenerSelect","$3c15aba5a275eda1$var$renderContentBasedOnConditions","dataset","action","dataStorage1"],"version":3,"file":"my-library.88f5e8aa.js.map"}