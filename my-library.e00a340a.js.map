{"mappings":"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","sources":["src/js/pages/my-library/my-library.js","src/js/pages/my-library/refs.js","src/js/components/select.js","src/js/pages/my-library/markupContentTextMessage.js"],"sourcesContent":["import Storage from '../../api/localStorageAPI/localStorageAPI';\nimport { STORAGE_KEY } from '../../localStorageKey/localStorageKey';\nimport { refs } from './refs';\nimport { createMarkupFilmsCards } from '../../components/createMarkupFilmCard';\nimport { markupContentTextMessage } from './markupContentTextMessage';\nimport { Loader } from '../../loader';\nimport { SelectService } from '../../components/select';\n\nconst PER_PAGE = 6;\n\nconst loader = new Loader();\n\nlet correctGenre = 'All';\nlet totalPage;\nlet page = 0;\nlet startIndex = 0;\nlet endIndex = 0;\nlet correctGenreMovieList = [];\n\nconst dataStorage = Storage.load(STORAGE_KEY.myLibraryMoviesList);\n\nrenderContentBasedOnConditions();\n\ndocument.addEventListener('click', function (e) {\n  if (e.target.dataset.action === 'add-remove-to-my-library') {\n    const dataStorage = Storage.load(STORAGE_KEY.myLibraryMoviesList);\n    if (dataStorage.length === 0) {\n      // refs.genreList.removeEventListener('change', onSelectGenreListChange);\n      refs.myLibrarySection.classList.add(\n        'my-library-content-text-message-section'\n      );\n      refs.libraryContent.innerHTML = markupContentTextMessage();\n    }\n\n    renderLibraryCards(dataStorage);\n  }\n});\n\nfunction renderContentBasedOnConditions() {\n  if (dataStorage?.length === 0) {\n    refs.genreList.removeEventListener('click', renderGenreList);\n    refs.myLibrarySection.classList.add(\n      'my-library-content-text-message-section'\n    );\n    refs.libraryContent.innerHTML = markupContentTextMessage();\n  } else if (dataStorage) {\n    //? Отримую унікальні ID жанрів фільмів, які є у localStorage і за допомогою функції createSelectOptionMarkup отримую розмітку з жанром, і вставляю у select\n    2;\n    const allGenres = dataStorage\n      .reduce((acc, el) => [...acc, ...el.genres], [])\n      .filter(\n        (genre, index, self) =>\n          index ===\n          self.findIndex(g => g.id === genre.id && g.name === genre.name)\n      );\n\n    const markupString = createSelectOption(allGenres);\n\n    const selectService = new SelectService(\n      '.js-select-my-library-genre-list',\n      markupString\n    );\n    selectService.addEventListenerSelect();\n\n    document\n      .querySelector('.select-my-library-option-list')\n      .addEventListener('click', renderGenreList);\n\n    renderLibraryCards(dataStorage);\n  } else {\n    refs.genreList.removeEventListener('click', renderGenreList);\n    refs.myLibrarySection.classList.add(\n      'my-library-content-text-message-section'\n    );\n    refs.libraryContent.innerHTML = markupContentTextMessage();\n  }\n}\n\nfunction createSelectOption(options) {\n  return options.map(({ id, name }) => {\n    return { value: id, text: name };\n  });\n}\n\nfunction renderGenreList(e) {\n  correctGenre = e.target.textContent;\n\n  page = 0;\n\n  if (correctGenre === 'All Genres') {\n    correctGenre = 'All Genres';\n    renderLibraryCards(dataStorage);\n    return;\n  }\n\n  correctGenreMovieList = dataStorage.filter(el => {\n    return el.genres.some(genre => genre.name === correctGenre);\n  });\n\n  renderLibraryCards(correctGenreMovieList);\n}\n\nasync function renderLibraryCards(movieList) {\n  loader.onShow();\n  startIndex = 0;\n  endIndex = PER_PAGE;\n  refs.moviesList.innerHTML = '';\n  refs.loadMoreButton.style.display = 'none';\n  if (movieList.length > PER_PAGE) {\n    refs.loadMoreButton.style.display = 'block';\n    refs.loadMoreButton.addEventListener('click', onloadMoreButtonClick);\n    localStoragePagination(startIndex, endIndex, movieList);\n  } else {\n    refs.moviesList.innerHTML = await createMarkupFilmsCards(movieList);\n  }\n  loader.onClose();\n}\n\nfunction onloadMoreButtonClick() {\n  loader.onShow();\n  refs.loadMoreButton.blur();\n\n  startIndex += PER_PAGE;\n  endIndex += PER_PAGE;\n\n  if (correctGenre === 'All Genres') {\n    localStoragePagination(startIndex, endIndex, dataStorage);\n  } else {\n    localStoragePagination(startIndex, endIndex, correctGenreMovieList);\n  }\n  loader.onClose();\n}\n\nasync function localStoragePagination(start, end, data) {\n  page += 1;\n\n  totalPage = data.length / PER_PAGE;\n\n  if (totalPage > page) {\n    const pagination = data.slice(start, end);\n\n    refs.moviesList.insertAdjacentHTML(\n      'beforeend',\n      await createMarkupFilmsCards(pagination)\n    );\n  } else {\n    const pagination = data.slice(start, end);\n    refs.moviesList.insertAdjacentHTML(\n      'beforeend',\n      await createMarkupFilmsCards(pagination)\n    );\n\n    refs.loadMoreButton.style.display = 'none';\n  }\n}\n","export const refs = {\n  myLibrarySection: document.getElementById('my-library'),\n  libraryContent: document.querySelector('.js-my-library-content'),\n  genreList: document.querySelector('.js-my-library-genre-list'),\n  moviesList: document.querySelector('.js-my-library-movies-list'),\n  loadMoreButton: document.querySelector('.js-my-library-load-more-button'),\n};\n","export class SelectService {\n  constructor(select, optionData = null) {\n    this.select = document.querySelector(select);\n\n    this.selectedValue = this.select.firstElementChild;\n    this.optionList = this.select.lastElementChild;\n    this.optionListFirstElementChild = this.optionList.firstElementChild;\n    this.optionData = optionData;\n    this.optionListValue = null;\n  }\n\n  addEventListenerSelect() {\n    this.select.classList.add('cs-select');\n    this.selectedValue.classList.add('cs-selected-option');\n    this.optionList.classList.add('cs-option-list');\n    this.optionListFirstElementChild.classList.add('cs-option');\n\n    this.selectedValue.addEventListener(\n      'mouseenter',\n      this.onSelectHover.bind(this)\n    );\n    this.selectedValue.addEventListener(\n      'mouseleave',\n      this.onSelectLostHover.bind(this)\n    );\n    this.optionList.addEventListener(\n      'mouseenter',\n      this.onSelectHover.bind(this)\n    );\n    this.optionList.addEventListener(\n      'mouseleave',\n      this.onSelectLostHover.bind(this)\n    );\n    if (this.optionData) {\n      this.optionList.insertAdjacentHTML(\n        'beforeend',\n        this.optionData\n          .map(\n            ({ value, text }) =>\n              `<div class=\"cs-option\" data-value=\"${value}\" class=\"\">${text}</div>`\n          )\n          .join('')\n      );\n    }\n  }\n\n  onSelectHover(e) {\n    this.select.classList.add('cs-select-active');\n\n    this.optionList.addEventListener('click', this.onOptionClick.bind(this));\n  }\n\n  onSelectLostHover(e) {\n    this.select.classList.remove('cs-select-active');\n    this.optionList.removeEventListener('click', this.onOptionClick.bind(this));\n  }\n\n  onOptionClick(e) {\n    this.optionListValue = e.target.textContent;\n    this.selectedValue.firstChild.textContent = this.optionListValue;\n    this.select.classList.remove('cs-select-active');\n\n    this.optionList.removeEventListener('click', this.onOptionClick);\n  }\n}\n\n//? ініціалізація екземпляра\n//  const selectService = new SelectService('Селектор', [markup]);\n//\n// selectService.addEventListenerSelect();\n\n//? html\n{\n  /* <div class=\"Селектор\">\n  <div>\n    All Genres\n    [svg-icon]\n  </div >\n    <div>\n      <div>All Genres</div>\n    </div>\n</div> */\n}\n\n//? css\n// .selected-option,\n// .option-list,\n// .option-list > div {\n//   position: relative;\n//   z-index: 11;\n//   background-color: rgb(41, 41, 41);\n// }\n\n// .selected-option,\n// .option-list > div {\n//   padding-top: 10px;\n//   padding-bottom: 10px;\n//   padding-right: 10px;\n//   padding-left: 10px;\n// }\n\n// .selected-option {\n//   border: 1px solid rgb(141, 141, 141);\n//   border-radius: 4px;\n// }\n\n// .option-list {\n//   /* pointer-events: none; */\n//   opacity: 0;\n//   visibility: hidden;\n//   position: absolute;\n\n//   transform: scaleY(0);\n//   transform-origin: top;\n\n//   transition: opacity 300ms ease-in-out, visibility 300ms ease-in-out,\n//     transform 300ms ease-in-out;\n// }\n\n// .option-list > div {\n//   border: 1px solid rgb(141, 141, 141);\n// }\n\n// .option-list > div:last-child {\n//   border-radius: 0px 0px 4px 4px;\n// }\n\n// .select-active .option-list {\n//   opacity: 1;\n//   visibility: visible;\n\n//   transform: scaleY(1);\n// }\n\n// .select-active .selected-option {\n//   border-radius: 4px 4px 0px 0px;\n// }\n","export function markupContentTextMessage() {\n  return ` \n    <p class=\"my-library-content-text-message\">\n        <span>OOPS...</span>\n        <span>We are very sorry!</span>\n        <span>You don’t have any movies at your library.</span>\n    </p>\n    <a class=\"button-accent my-library-content-text-message-button\" href=\"./catalog.html\">Search movie</a>\n    `;\n}\n"],"names":["$2xHB1","parcelRequire","$32ff713042e80194$export$21666b427502ea6d","myLibrarySection","document","getElementById","libraryContent","querySelector","genreList","moviesList","loadMoreButton","$86e62dc1df74d56b$export$448ee86705ad98f3","constructor","select","optionData","this","selectedValue","firstElementChild","optionList","lastElementChild","optionListFirstElementChild","optionListValue","addEventListenerSelect","classList","add","addEventListener","onSelectHover","bind","onSelectLostHover","insertAdjacentHTML","map","value","text","join","e","onOptionClick","remove","removeEventListener","target","textContent","firstChild","$71d3b8b212f642f2$var$loader","$gjiCh","Loader","$71d3b8b212f642f2$var$totalPage","$71d3b8b212f642f2$var$correctGenre","$71d3b8b212f642f2$var$page","$71d3b8b212f642f2$var$startIndex","$71d3b8b212f642f2$var$endIndex","$71d3b8b212f642f2$var$correctGenreMovieList","$71d3b8b212f642f2$var$dataStorage","default","load","$78eZQ","STORAGE_KEY","myLibraryMoviesList","$71d3b8b212f642f2$var$renderGenreList","$71d3b8b212f642f2$var$renderLibraryCards","filter","el","genres","some","genre","name","async","movieList","onShow","innerHTML","style","display","length","$71d3b8b212f642f2$var$onloadMoreButtonClick","$71d3b8b212f642f2$var$localStoragePagination","$1nG8V","createMarkupFilmsCards","onClose","blur","start","end","data","pagination","slice","allGenres","reduce","acc","index","self","findIndex","g","id","markupString","$71d3b8b212f642f2$var$renderContentBasedOnConditions","dataset","action","dataStorage1"],"version":3,"file":"my-library.e00a340a.js.map"}